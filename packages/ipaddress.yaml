# Internet HASS Module
#
# Provides external IP address.

sensor:

  - platform: rest
    resource: http://ip.jsontest.com
    name: External IP
    scan_interval: 900
    value_template: '{{ value_json.ip }}'

  - platform: speedtest
    minute: 30
    hour:
      - 0
      - 6
      - 12
      - 18
    monitored_conditions:
      - download
      - upload
    
# Report IP changes
automation:

  - alias: IP Changed
    trigger:
      - platform: state
        entity_id: sensor.external_ip
    action:
      - service: script.notify
        data_template:
          notify_text: "The externa ip address has changed to: '{{ states.sensor.external_ip.state }}'"
          notify_mobile: True
          is_warning: True
